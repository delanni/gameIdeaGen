<DOCYPE html>
<html>
	<head>
		<meta charset='utf-8'>
		<meta encoding='utf-8'>
		<style type="text/css">
			
		</style>
		<title> Game Idea Generator </title>
	</head>
	<body>
		<div>
			<h1 id="nameLabel"></h1>
			<div><span>Genre: </span><span id="genreLabel"></span></div>
			<div><span>Theme: </span><span id="themeLabel"></span></div>
			<div><span>Core Mechanics: </span><span id="coreMechanicsLabel"></span></div>
			<div><span>Extra: </span><span id="extraLabel"></span></div>
		</div>
		<input type='button' value='Hit me!' onclick="pick()"></input>
		
		<script type="text/javascript">
			window.onerror = function(e){
				alert(e);
			}
			
			var stateObject = {
				genre:"",
				theme:"",
				coreMechanics:"",
				extra:"",
				_prefix:"",
				_bridge:"",
				_postfix:"",
				get name(){ return stateObject._prefix+stateObject._bridge+stateObject._postfix }
			};
			
			Object.prototype.map = function(transfn){
				var k = Object.keys(this);
				var out = {};
				for(var i=0;i<k.length;i++){
					out[k[i]] = transfn(this[k[i]]);
				}
				return out;
			};
			
			var possibilities = {
				genre:["Business", "Stealth", "Sandbox", "Racing", "Sports", "Maze","MOBA","Fighting", "Action", "Platformer", "FPS", "RTS", "Turn based", "Simulation", "Toilet-game", "Role playing"],
				theme:["Ghost", "Cat", "Dogs", "Pixies","Apocalypse", "Dragon", "Horror", "Time travel", "World war","Ninjas","Pirates","Aliens","Business","Superheroes", "Animals", "Zombies", "Middle ages", "Tech", "Hell", "Ponycorn", "Kids", "Old people", "Sexy"],
				coreMechanics:["Button smashing", "Serenity", "Risk and reward","Worker placement","Pointless", "Waiting", "Cards", "Capture/eliminate","Tap-tap","Timed interaction","Micro management", "Run around", "Explosions", "Agility", "WASD"],
				extra:["Audio", "RPG elements", "BLOOD", "2d", "3d", "Explosions", "Action elements","Ponies"],
				_prefix:["Journey","Terror", "Dream","Raiders","Killers","6 feet", "Omiguzu", "Brothers", "Blood", "Heroes", "Zombies", "Mommy", "Anger", "Money"],
				_bridge: [" of "," ", "'s ","-"," and ",", Money, ", " without ", " of the ", " against ", " who love ", " vs. ", " for ", " and the ", " to the "],
				_postfix : ["Iwagashi", "Pidgeons", "Void","Love", "Dirt", "Seven seas", "Monkey bees", "Dogs", "Unlimited", "Stars", "Universe", "Death", "Demons", "Money"]
			}

			function pick(choiceKey){
				var traits = Object.keys(stateObject);

				if (choiceKey){
					var choice = {};
					choiceKey.split("").map(function(letter,traitId){
						var idx = letter.charCodeAt(0) - "a".charCodeAt(0);
						choice[traits[traitId]] = possibilities[traits[traitId]][idx];
					});
				}  else {
					var code = "";
					var choice = possibilities.map(function(trait){
						var r = Math.floor(Math.random()*trait.length);
						code += String.fromCharCode(r+'a'.charCodeAt(0));
						return trait[r];
					});
					window.location.hash = code;
				}
				
				traits.forEach(function(k){
					stateObject[k] = choice[k];
					var el = document.getElementById(k+"Label");
					el && (el.textContent = stateObject[k]);
				});
			}

			window.onpopstate = function(){
				if (window.location.hash){
					pick(window.location.hash.substring(1));
				}
			}

			pick(window.location.hash.substring(1));
			
		</script>
		<footer>Â©Sphynx ag., 2015</footer>
	</body>
</html>
